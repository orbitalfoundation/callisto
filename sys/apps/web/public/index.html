<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Orbital</title>
<link rel="stylesheet" type="text/css" href="/index.css">
</head>
<body>
<div class="innerbody">

<section class="header">
<br>
<h1>Orbital Apps</h1>
<div id=signin style="float:right">Sign In Using Keplr</div>
<br>
<hr>
</section>

<div id="yourapps" style="display:none">
<h2>Your Apps</h2>
<div id="loader_yours" class="loader">Loading...</div>
<div id="layout_yours"></div>
</div>

<div id="tutorials">
<h2>Tutorials</h2>
<div id="loader_tutorials" class="loader">Loading...</div>
<div id="layout_tutorials"></div>
</div>

<div id="popular">
<h2>Popular</h2>
<div id="loader_popular" class="loader">Loading...</div>
<div id="layout_popular"></div>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
</div>

<br>
<br>
<br>
<br>
<br>
<h1>Orbital Components</h1>
<hr/>

<div id="popular">
<h2>Popular Components</h2>
<div id="loader_components" class="loader">Loading...</div>
<div id="layout_components"></div>
</div>

</div>
</body>
</html>

<script type="module">

import {yours_data, tutorials_data, popular_data, components_data } from "./data.js"
import {CardSmall, CardSmallCollection} from './cards.js'

function yours_load() {
	let query = { observe: (callback => { callback(yours_data) }) }
	document.getElementById("layout_yours").appendChild(new CardSmallCollection(query))
	document.getElementById("loader_yours").remove();
}

function tutorials_load() {
	let query = { observe: (callback => { callback(tutorials_data) }) }
	document.getElementById("layout_tutorials").appendChild(new CardSmallCollection(query))
	document.getElementById("loader_tutorials").remove();
}

function popular_load() {
	let query = { observe: (callback => { callback(popular_data) }) }
	document.getElementById("layout_popular").appendChild(new CardSmallCollection(query))
	document.getElementById("loader_popular").remove();
}

function components_load() {
	let query = { observe: (callback => { callback(components_data) }) }
	document.getElementById("layout_components").appendChild(new CardSmallCollection(query,{width:"200px",text:false}))
	document.getElementById("loader_components").remove();
}

setTimeout(tutorials_load,1000)
setTimeout(popular_load,1500)
setTimeout(components_load,1500)


async function keplr() {
	if(yourapps.style.display == "block") {
		yourapps.style.display = "none"
		signin.innerHTML = "Sign In Using Keplr"
		return
	}
	if (!window.keplr) {
		alert("Please install or enable keplr.app")
	} else {
		const chainId = "cosmoshub-4";
		await window.keplr.enable(chainId);
		const offlineSigner = window.keplr.getOfflineSigner(chainId);
		const accounts = await offlineSigner.getAccounts();
		// -> get the actual user here not me
		signin.innerHTML = "Welcome Anselm | Logout"
		yourapps.style.display = "block"
		setTimeout(yours_load,1000)
	}
}

signin.onclick = keplr


</script>

